#!/bin/python3
import socket
import sys
from datetime import datetime


if len(sys.argv) == 2: #Array with file name and IP or Host
    target = socket.gethostbyname(sys.argv[1]) # RESOLVE IPV4
    print('-' * 40)
    print(f'Scanning target {target}')
    print(f'Time started: {datetime.now()}')
    print('-' * 40)
else:
    print('Invalid amount of arguments')
    print('Syntax: python3 scanner.py <ip>')
    sys.exit()

try:
    for port in range(1, 65535):
        my_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        socket.setdefaulttimeout(1)
        result = my_socket.connect_ex((target, port))
        if result == 0:
            print(f'Port {port} is open')
        my_socket.close()

except KeyboardInterrupt:
    print('\nExiting program.')
    sys.exit()

except socket.gaierror:
    print('Host could not be resolved.')
    sys.exit()

except socket.error:
    print('Could not connect to server.')
    sys.exit()
